<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 5 Chunks Review</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;800&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Lexend', 'Noto Sans TC', sans-serif; background: #fefce8; }
        .chunk-highlight { color: #8b5cf6; font-weight: 800; text-decoration: underline; text-underline-offset: 4px; }
        .tab-active { background: #8b5cf6; color: white; transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05); }
        .btn-check { transition: all 0.2s; border-width: 2px; }
        .btn-check:active { transform: scale(0.95); }
        .screenshot-area { background: white; border: 2px solid #e2e8f0; padding: 2rem; border-radius: 1.5rem; }
    </style>
</head>
<body class="min-h-screen pb-20">

    <nav class="bg-white border-b sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 h-16 flex items-center justify-between">
            <h1 class="text-xl font-bold text-violet-800 flex items-center">
                <span class="mr-2 text-2xl">ğŸ“š</span> Lesson 5 èªå¡Šå°ˆå®¶
            </h1>
            <div class="flex space-x-1 bg-slate-100 p-1 rounded-xl text-sm">
                <button onclick="switchMode('list')" id="btn-mode-list" class="px-4 py-2 rounded-lg font-bold transition tab-active">å…¨éƒ¨ä¾‹å¥</button>
                <button onclick="switchMode('quiz')" id="btn-mode-quiz" class="px-4 py-2 rounded-lg font-bold transition text-slate-500">èªå¡ŠæŒ‘æˆ°</button>
            </div>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto p-4 pt-8">

        <div id="mode-list" class="mode-content space-y-4">
            <div class="bg-violet-50 p-4 rounded-2xl border border-violet-100 mb-6 flex items-center">
                <span class="text-2xl mr-3">ğŸ’¡</span>
                <p class="text-violet-900 text-sm font-medium">é€™æ˜¯ç¬¬ 5 èª²ç²¾æº–èªå¡Šç·´ç¿’ï¼æŒ‘æˆ°æ¨¡å¼æœƒéš¨æ©ŸæŠ½å‡º 10 é¡Œå–”ï¼</p>
            </div>
            <div id="list-container" class="space-y-4"></div>
        </div>

        <div id="mode-quiz" class="mode-content hidden">
            <div id="quiz-auth" class="bg-white rounded-3xl card-shadow p-10 text-center border border-slate-100">
                <h2 class="text-2xl font-bold text-slate-800 mb-4">æº–å‚™å¥½é–‹å§‹æŒ‘æˆ°äº†å—ï¼Ÿ</h2>
                <p class="text-slate-500 mb-8">è«‹è¼¸å…¥ä½ çš„å§“åä»¥é–‹å§‹ 10 é¡Œéš¨æ©Ÿèªå¡ŠæŒ‘æˆ°ï¼š</p>
                <input type="text" id="student-name" placeholder="è«‹è¼¸å…¥å§“å" class="w-full max-w-xs mx-auto block p-4 border-2 border-slate-200 rounded-xl mb-6 focus:border-violet-400 focus:outline-none font-bold text-center text-lg">
                <button onclick="initQuizSession()" class="bg-violet-500 text-white px-12 py-4 rounded-xl font-black shadow-lg hover:bg-violet-600 transition text-lg">é–‹å§‹æŒ‘æˆ°</button>
            </div>

            <div id="quiz-play" class="hidden">
                <div class="bg-white rounded-3xl card-shadow p-8 mb-8 border border-slate-100">
                    <div class="flex justify-between items-center mb-8">
                        <span id="quiz-progress" class="font-black text-violet-700 bg-violet-50 px-4 py-1.5 rounded-full text-sm tracking-widest">STEP 1/10</span>
                        <div class="text-right">
                            <p id="quiz-user-display" class="text-xs text-slate-400 font-bold uppercase"></p>
                            <span id="quiz-score" class="text-orange-500 font-bold bg-orange-50 px-4 py-1.5 rounded-full text-sm">SCORE: 0</span>
                        </div>
                    </div>
                    <div id="quiz-area" class="text-center min-h-[140px] flex flex-col justify-center"></div>
                    <div id="quiz-feedback" class="mt-8 text-center h-8 font-bold text-lg"></div>
                </div>
                <div id="quiz-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
            </div>

            <div id="quiz-result" class="hidden">
                <div class="screenshot-area shadow-2xl" id="final-report">
                    <div class="text-center mb-6">
                        <div class="text-6xl mb-4">ğŸ–ï¸</div>
                        <h2 class="text-3xl font-black text-slate-800">Lesson 5 èªå¡ŠæŒ‘æˆ°å ±å‘Š</h2>
                        <div class="w-16 h-1 bg-violet-500 mx-auto mt-2"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div class="bg-slate-50 p-4 rounded-xl">
                            <p class="text-slate-400 text-xs font-bold uppercase mb-1">å­¸ç”Ÿå§“å</p>
                            <p id="res-name" class="text-xl font-black text-slate-700"></p>
                        </div>
                        <div class="bg-slate-50 p-4 rounded-xl">
                            <p class="text-slate-400 text-xs font-bold uppercase mb-1">å®Œæˆæ—¥æœŸ</p>
                            <p id="res-date" class="text-xl font-black text-slate-700"></p>
                        </div>
                        <div class="bg-violet-500 p-4 rounded-xl col-span-2 text-center">
                            <p class="text-violet-100 text-xs font-bold uppercase mb-1">æœ€çµ‚å¾—åˆ† (Total Score)</p>
                            <p id="res-score" class="text-4xl font-black text-white"></p>
                        </div>
                    </div>
                    <p class="text-center text-slate-400 text-sm italic">ğŸ“¸ è«‹æˆªåœ–æ­¤ç•«é¢å‚³é€çµ¦è€å¸«é€²è¡Œæ ¸å°</p>
                </div>
                <div class="flex justify-center mt-8 space-x-4">
                    <button onclick="switchMode('list')" class="bg-slate-200 text-slate-600 px-8 py-3 rounded-full font-bold">è¿”å›åˆ—è¡¨</button>
                    <button onclick="switchMode('quiz')" class="bg-violet-500 text-white px-8 py-3 rounded-full font-bold shadow-lg">é‡æ–°æŒ‘æˆ°</button>
                </div>
            </div>
        </div>
    </main>

    <script>
        const rawData = [
            { id: 1, eng: "My grandmother is 75 years old, but she can use her smartphone **without difficulty**.", chunk: "without difficulty", chn: "æˆ‘çš„ç¥–æ¯75æ­²äº†ï¼Œä½†å¥¹å¯ä»¥**æ¯«ç„¡å›°é›£åœ°**ä½¿ç”¨æ™ºæ…§å‹æ‰‹æ©Ÿã€‚" },
            { id: 2, eng: "It was **difficult for** the blind man **to** take care of himself after his wife passed away.", chunk: "difficult for...to", chn: "åœ¨é‚£ä½ç›²äººçš„å¦»å­å»ä¸–å¾Œï¼Œ**å°**ä»–ä¾†èªªç…§é¡§è‡ªå·±æ˜¯å¾ˆ**å›°é›£çš„**ã€‚" },
            { id: 3, eng: "Youâ€™d better get up now; **otherwise**, you wonâ€™t be able to catch the flight.", chunk: "otherwise", chn: "ä½ æœ€å¥½ç¾åœ¨èµ·åºŠï¼›**å¦å‰‡**ï¼Œä½ å°‡ç„¡æ³•è¶•ä¸Šé£›æ©Ÿã€‚" },
            { id: 4, eng: "Jennyâ€™s boss was standing behind her while she was working, but she wasnâ€™t **aware of** it.", chunk: "aware of", chn: "çå¦®å·¥ä½œæ™‚è€é—†æ­£ç«™åœ¨å¥¹èº«å¾Œï¼Œä½†å¥¹ä¸¦æ²’æœ‰**å¯Ÿè¦ºåˆ°**ã€‚" },
            { id: 5, eng: "Oliver drank too much and never cared about his health. He **eventually** got sick.", chunk: "eventually", chn: "å¥§åˆ©ä½›å–å¾—å¤ªå¤šä¸”å¾ä¸é—œå¿ƒè‡ªå·±çš„å¥åº·ã€‚ä»–**çµ‚æ–¼**ç—…å€’äº†ã€‚" },
            { id: 6, eng: "We are trying to guess the **eventual result** of the World Cup.", chunk: "eventual result", chn: "æˆ‘å€‘æ­£è©¦è‘—çŒœæ¸¬ä¸–ç•Œç›ƒçš„**æœ€çµ‚çµæœ**ã€‚" },
            { id: 7, eng: "I called the hotel to **confirm our stay** for next weekend.", chunk: "confirm our stay", chn: "æˆ‘æ‰“é›»è©±çµ¦é£¯åº—**ç¢ºèªæˆ‘å€‘**ä¸‹é€±æœ«çš„**ä½å®¿**ã€‚" },
            { id: 8, eng: "My little brother is **scared of** bugs. He is even afraid of ants.", chunk: "scared of", chn: "æˆ‘çš„å°å¼Ÿå¾ˆ**å®³æ€•**æ˜†èŸ²ã€‚ä»–ç”šè‡³é€£èèŸ»éƒ½æ€•ã€‚" },
            { id: 9, eng: "The movie **scared my brother**, and he couldnâ€™t sleep.", chunk: "scared my brother", chn: "é€™éƒ¨é›»å½±**åš‡å£äº†æˆ‘å“¥å“¥**ï¼Œè®“ä»–ç¡ä¸è‘—è¦ºã€‚" },
            { id: 10, eng: "Because the final **exams are approaching**, most of my classmates are studying in the library.", chunk: "exams are approaching", chn: "å› ç‚ºæœŸæœ«**è€ƒè©¦å¿«æ¥è¿‘äº†**ï¼Œæˆ‘å¤§éƒ¨åˆ†çš„åŒå­¸éƒ½åœ¨åœ–æ›¸é¤¨è®€æ›¸ã€‚" },
            { id: 11, eng: "It is better to get a pet from an **animal shelter**; you may save its life.", chunk: "animal shelter", chn: "å¾**å‹•ç‰©æ”¶å®¹æ‰€**é ˜é¤Šå¯µç‰©æ¯”è¼ƒå¥½ï¼›ä½ å¯èƒ½æœƒæ•‘å®ƒä¸€å‘½ã€‚" },
            { id: 12, eng: "The department store **becomes very crowded** when there is a big sale.", chunk: "becomes very crowded", chn: "ç™¾è²¨å…¬å¸åœ¨å¤§ç‰¹åƒ¹æ™‚æœƒ**è®Šå¾—éå¸¸æ“æ“ **ã€‚" },
            { id: 13, eng: "I enjoy my job as a waiter, but I donâ€™t think I will **work** in the restaurant **forever**.", chunk: "work...forever", chn: "æˆ‘å–œæ­¡æˆ‘ç•¶æœå‹™å“¡çš„å·¥ä½œï¼Œä½†æˆ‘ä¸èªç‚ºæˆ‘æœƒ**æ°¸é **åœ¨é¤å»³**å·¥ä½œ**ã€‚" },
            { id: 14, eng: "The **terrified kitten** hid under a car when a boy tried to catch her.", chunk: "terrified kitten", chn: "ç•¶ä¸€å€‹ç”·å­©è©¦è‘—æŠ“é‚£éš»å°è²“æ™‚ï¼Œ**æ„Ÿåˆ°ææ‡¼çš„å°è²“**èº²åœ¨è»Šå­åº•ä¸‹ã€‚" },
            { id: 15, eng: "The monster on TV **terrified the little girl**.", chunk: "terrified the little girl", chn: "é›»è¦–ä¸Šçš„æ€ªç‰©**åš‡å£äº†é‚£å€‹å°å¥³å­©**ã€‚" },
            { id: 16, eng: "The kids played around for hours in the yard, and they all **felt exhausted**.", chunk: "felt exhausted", chn: "å­©å­å€‘åœ¨é™¢å­è£¡ç©äº†å¥½å¹¾å€‹å°æ™‚ï¼Œä»–å€‘éƒ½**æ„Ÿåˆ°ç²¾ç–²åŠ›ç«­**ã€‚" },
            { id: 17, eng: "The long walk **exhausted the old man**, so he lay down and took a nap.", chunk: "exhausted the old man", chn: "é•·é€”è·‹æ¶‰è®“**è€äººç²¾ç–²åŠ›ç«­**ï¼Œæ‰€ä»¥ä»–èººä¸‹ç¡äº†å€‹åˆè¦ºã€‚" },
            { id: 18, eng: "Janet **awoke when** the alarm went off.", chunk: "awoke when", chn: "ç•¶é¬§é˜éŸ¿èµ·**æ™‚**ï¼Œçå¦®ç‰¹**é†’äº†éä¾†**ã€‚" },
            { id: 19, eng: "When Dad needs to work late, he usually drinks a cup of black coffee to **stay awake**.", chunk: "stay awake", chn: "ç•¶çˆ¸çˆ¸éœ€è¦åŠ ç­æ™‚ï¼Œä»–é€šå¸¸æœƒå–æ¯é»‘å’–å•¡ä¾†**ä¿æŒæ¸…é†’**ã€‚" },
            { id: 20, eng: "Lily wanted to have a dog, so her mom took her to a shelter to **adopt one**.", chunk: "adopt one", chn: "è‰è‰æƒ³é¤Šéš»ç‹—ï¼Œæ‰€ä»¥å¥¹åª½åª½å¸¶å¥¹å»æ”¶å®¹æ‰€**é ˜é¤Šäº†ä¸€éš»**ã€‚" },
            { id: 21, eng: "It **was a blessing** that Ruby didnâ€™t really get hurt when she fell off the second-floor balcony.", chunk: "was a blessing", chn: "éœ²æ¯”å¾äºŒæ¨“é™½å°æ‘”ä¸‹ä¾†å»æ²’å—é‡å‚·ï¼Œ**çœŸæ˜¯ä»¶å¹¸äº‹**ã€‚" },
            { id: 22, eng: "**God bless you** for your kind and generous help.", chunk: "God bless you", chn: "**é¡˜ä¸Šå¸ç¥ç¦ä½ **ï¼Œå› ç‚ºä½ ä»æ…ˆå¤§æ–¹çš„å¹«åŠ©ã€‚" },
            { id: 23, eng: "Michael **used to go** to the movies alone before he got married.", chunk: "used to go", chn: "éº¥å¯çµå©šå‰**éå»ç¶“å¸¸å»**çœ‹é›»å½±ã€‚" },
            { id: 24, eng: "The parents **took good care of** their son, so he could recover quickly from his surgery.", chunk: "took good care of", chn: "çˆ¶æ¯æ‚‰å¿ƒåœ°**ç…§é¡§**ä»–å€‘çš„å…’å­ï¼Œè®“ä»–èƒ½å¾æ‰‹è¡“ä¸­è¿…é€Ÿåº·å¾©ã€‚" },
            { id: 25, eng: "**At first**, we didnâ€™t think Max could make anything, but later we were very impressed by his invention.", chunk: "At first", chn: "**èµ·åˆ**ï¼Œæˆ‘å€‘ä¸èªç‚ºéº¥å…‹æ–¯èƒ½åšå‡ºä»€éº¼ï¼Œä½†å¾Œä¾†æˆ‘å€‘å°ä»–çš„ç™¼æ˜å°è±¡æ·±åˆ»ã€‚" },
            { id: 26, eng: "Now Lucy listens to music online, and she does **not** record songs from the radio **anymore**.", chunk: "not...anymore", chn: "ç¾åœ¨éœ²è¥¿åœ¨ç¶²è·¯ä¸Šè½éŸ³æ¨‚ï¼Œå¥¹**ä¸å†**å¾æ”¶éŸ³æ©ŸéŒ„æ­Œ**äº†**ã€‚" },
            { id: 27, eng: "Dave turned around **all of a sudden** and stepped on my toes.", chunk: "all of a sudden", chn: "å¤§è¡›**çªç„¶é–“**è½‰èº«è¸©åˆ°äº†æˆ‘çš„è…³è¶¾ã€‚" },
            { id: 28, eng: "After hours of waiting, we got the tickets to the show **at last**.", chunk: "at last", chn: "ç¶“éå¥½å¹¾å€‹å°æ™‚çš„ç­‰å¾…ï¼Œæˆ‘å€‘**çµ‚æ–¼**æ‹¿åˆ°äº†æ¼”å‡ºçš„ç¥¨ã€‚" },
            { id: 29, eng: "Most of the passengers on the train were **nodding off** during the trip.", chunk: "nodding off", chn: "ç«è»Šä¸Šå¤§éƒ¨åˆ†çš„ä¹˜å®¢åœ¨æ—…é€”ä¸­éƒ½åœ¨**æ‰“çŒç¡**ã€‚" }
        ];

        let currentIdx = 0;
        let score = 0;
        let quizPool = [];
        let userName = "";

        window.onload = () => { renderList(); };

        function speak(text) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text.replace(/\*\*/g, ''));
            utterance.lang = 'en-US';
            utterance.rate = 0.8;
            window.speechSynthesis.speak(utterance);
        }

        function switchMode(mode) {
            document.querySelectorAll('.mode-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('mode-' + mode).classList.remove('hidden');
            document.querySelectorAll('nav button').forEach(el => el.classList.remove('tab-active', 'text-slate-500'));
            document.getElementById('btn-mode-' + mode).classList.add('tab-active');
            if (mode === 'quiz') {
                document.getElementById('quiz-auth').classList.remove('hidden');
                document.getElementById('quiz-play').classList.add('hidden');
                document.getElementById('quiz-result').classList.add('hidden');
            }
        }

        function renderList() {
            const container = document.getElementById('list-container');
            container.innerHTML = "";
            rawData.forEach(item => {
                const htmlEng = item.eng.replace(/\*\*(.*?)\*\*/g, `<span class="chunk-highlight cursor-pointer" onclick="event.stopPropagation(); speak('$1')">$1</span>`);
                const htmlChn = item.chn.replace(/\*\*(.*?)\*\*/g, `<span class="text-violet-600 underline font-bold">$1</span>`);
                const card = document.createElement('div');
                card.className = "bg-white p-6 rounded-2xl border border-slate-100 card-shadow flex items-start space-x-4 hover:border-violet-200 transition-colors";
                card.innerHTML = `
                    <div class="mt-1 flex flex-col items-center">
                        <span class="text-xs font-black text-slate-300 mb-2">#${item.id}</span>
                        <button onclick="speak('${item.eng}')" class="p-2 bg-violet-50 rounded-full text-violet-500 hover:bg-violet-100 transition shadow-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M160,32V224a8,8,0,0,1-12.91,6.31L77.25,176H32a16,16,0,0,1-16-16V96A16,16,0,0,1,32,80H77.25l69.84-54.31A8,8,0,0,1,160,32Z"></path></svg>
                        </button>
                    </div>
                    <div class="flex-1">
                        <p class="text-xl text-slate-800 font-medium leading-relaxed">${htmlEng}</p>
                        <p class="text-slate-400 text-sm mt-2 font-bold">${htmlChn}</p>
                    </div>`;
                container.appendChild(card);
            });
        }

        function initQuizSession() {
            const nameField = document.getElementById('student-name');
            if (!nameField.value.trim()) { nameField.classList.add('border-red-400'); return; }
            userName = nameField.value.trim();
            document.getElementById('quiz-auth').classList.add('hidden');
            document.getElementById('quiz-play').classList.remove('hidden');
            document.getElementById('quiz-user-display').innerText = `Student: ${userName}`;
            startQuiz();
        }

        function startQuiz() {
            currentIdx = 0; score = 0;
            quizPool = [...rawData].sort(() => Math.random() - 0.5).slice(0, 10);
            updateQuiz();
        }

        function updateQuiz() {
            if (currentIdx >= quizPool.length) { showFinalReport(); return; }
            const q = quizPool[currentIdx];
            document.getElementById('quiz-progress').innerText = `STEP ${currentIdx + 1}/10`;
            document.getElementById('quiz-score').innerText = `SCORE: ${score}`;
            document.getElementById('quiz-feedback').innerText = "";
            const area = document.getElementById('quiz-area');
            
            // Mask all chunks in the sentence
            const displayQ = q.eng.replace(/\*\*(.*?)\*\*/g, '<span class="bg-violet-50 text-violet-50 px-3 py-1 rounded-lg border-b-2 border-violet-400 mx-1">__________</span>');
            
            area.innerHTML = `<p class="text-slate-400 text-sm mb-4 font-bold tracking-widest uppercase">Select the correct chunk:</p><h3 class="text-2xl md:text-3xl font-extrabold text-slate-800 leading-relaxed">${displayQ}</h3><p class="mt-4 text-slate-500 font-bold">æ„ç¾©ï¼š${q.chn.replace(/\*\*/g, '')}</p>`;
            
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = "";
            
            // Create options logic
            let distractors = rawData.filter(d => d.chunk !== q.chunk).map(d => d.chunk);
            distractors = [...new Set(distractors)].sort(() => Math.random() - 0.5).slice(0, 3);
            let allOptions = [q.chunk, ...distractors].sort(() => Math.random() - 0.5);
            
            allOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "bg-white border-2 border-slate-100 p-5 rounded-2xl font-bold text-slate-600 hover:border-violet-400 hover:text-violet-600 hover:bg-violet-50 transition btn-check text-lg shadow-sm";
                btn.innerText = opt;
                btn.onclick = () => { if(document.getElementById('quiz-feedback').innerText !== "") return; check(opt, q.chunk, btn); };
                optionsContainer.appendChild(btn);
            });
        }

        function check(selected, correct, btn) {
            const feedback = document.getElementById('quiz-feedback');
            if (selected === correct) {
                score += 10;
                btn.classList.replace('border-slate-100', 'border-green-500'); btn.classList.add('bg-green-50', 'text-green-600');
                feedback.innerHTML = "âœ… Excellent! +10 pts"; feedback.className = "mt-8 text-center font-bold text-green-500 text-xl animate-bounce";
                speak(quizPool[currentIdx].eng);
            } else {
                btn.classList.replace('border-slate-100', 'border-red-500'); btn.classList.add('bg-red-50', 'text-red-600');
                feedback.innerHTML = `âŒ Oops! It's <span class='underline'>${correct}</span>`;
                feedback.className = "mt-8 text-center font-bold text-red-500 text-xl";
            }
            setTimeout(() => { currentIdx++; updateQuiz(); }, 2200);
        }

        function showFinalReport() {
            document.getElementById('quiz-play').classList.add('hidden');
            document.getElementById('quiz-result').classList.remove('hidden');
            document.getElementById('res-name').innerText = userName;
            document.getElementById('res-score').innerText = `${score} / 100`;
            const now = new Date();
            document.getElementById('res-date').innerText = `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()} ${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')}`;
        }
    </script>
</body>
</html>